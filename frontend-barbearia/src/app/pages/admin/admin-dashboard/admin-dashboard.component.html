<div class="admin-dashboard">
  <!-- Header -->
  <div class="dashboard-header">
    <div class="header-left">
      <h1>ğŸ¯ Dashboard Administrativo</h1>
      <p class="subtitle">VisÃ£o geral completa do sistema</p>
    </div>
    
    <!-- Seletor de Unidade -->
    <div class="unidade-selector">
      <label>Unidade:</label>
      <select 
        [(ngModel)]="unidadeSelecionada" 
        (change)="selecionarUnidade()"
        [disabled]="carregandoUnidades">
        <option *ngFor="let unidade of unidades" [value]="unidade.id_unidade">
          ğŸª {{ unidade.nome }}
        </option>
      </select>
    </div>
  </div>

  <!-- Loading -->
  <div *ngIf="carregando" class="loading-state">
    <div class="spinner"></div>
    <p>Carregando estatÃ­sticas...</p>
  </div>

  <!-- Dashboard Content -->
  <div *ngIf="!carregando && estatisticas" class="dashboard-content">
    
    <!-- Vendas -->
    <div class="vendas-section">
      <div class="section-title">
        <h2>ğŸ’° Vendas</h2>
      </div>
      
      <div class="vendas-grid">
        <div class="venda-card hoje">
          <div class="venda-header">
            <span class="venda-icon">ğŸ“†</span>
            <h3>Hoje</h3>
          </div>
          <div class="venda-value">{{ formatarPreco(estatisticas.vendasHoje.valor_total) }}</div>
          <div class="venda-detail">{{ estatisticas.vendasHoje.total_vendas }} vendas realizadas</div>
        </div>

        <div class="venda-card mes">
          <div class="venda-header">
            <span class="venda-icon">ğŸ“Š</span>
            <h3>Este MÃªs</h3>
          </div>
          <div class="venda-value">{{ formatarPreco(estatisticas.vendasMes.valor_total) }}</div>
          <div class="venda-detail">{{ estatisticas.vendasMes.total_vendas }} vendas no total</div>
        </div>
      </div>
    </div>

    <!-- Duas Colunas: UsuÃ¡rios por Tipo e Agendamentos por Status -->
    <div class="two-columns">
      <!-- UsuÃ¡rios por Tipo -->
      <div class="info-card">
        <div class="card-title">
          <h3>ğŸ‘¤ UsuÃ¡rios por Tipo</h3>
        </div>
        <div class="list-items">
          <div *ngFor="let item of estatisticas.usuariosPorTipo" class="list-item">
            <div class="item-left">
              <span class="item-icon">{{ getTipoIcon(item.tipo) }}</span>
              <span class="item-name">{{ getTipoLabel(item.tipo) }}</span>
            </div>
            <span class="item-value">{{ item.quantidade }}</span>
          </div>
          <div *ngIf="estatisticas.usuariosPorTipo.length === 0" class="empty-message">
            Nenhum dado disponÃ­vel
          </div>
        </div>
      </div>

      <!-- Agendamentos por Status -->
      <div class="info-card">
        <div class="card-title">
          <h3>ğŸ“‹ Agendamentos por Status</h3>
        </div>
        <div class="list-items">
          <div *ngFor="let item of estatisticas.agendamentosPorStatus" class="list-item">
            <div class="item-left">
              <span class="item-icon">{{ getStatusIcon(item.status) }}</span>
              <span class="item-name">{{ getStatusLabel(item.status) }}</span>
            </div>
            <span class="item-value">{{ item.quantidade }}</span>
          </div>
          <div *ngIf="estatisticas.agendamentosPorStatus.length === 0" class="empty-message">
            Nenhum agendamento registrado
          </div>
        </div>
      </div>
    </div>

    <!-- Top 5 Unidades Mais Ativas -->
    <div class="info-card full-width">
      <div class="card-title">
        <h3>ğŸ† Top 5 Unidades Mais Ativas (Este MÃªs)</h3>
      </div>
      <div class="table-responsive">
        <table class="ranking-table">
          <thead>
            <tr>
              <th>PosiÃ§Ã£o</th>
              <th>Nome da Unidade</th>
              <th>Agendamentos</th>
              <th>Receita</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let unidade of estatisticas.unidadesAtivas; let i = index">
              <td>
                <span class="posicao" [class.top1]="i === 0" [class.top2]="i === 1" [class.top3]="i === 2">
                  {{ i + 1 }}Âº
                </span>
              </td>
              <td class="unidade-nome">{{ unidade.nome }}</td>
              <td>{{ unidade.total_agendamentos }}</td>
              <td class="receita">{{ formatarPreco(unidade.receita_mes) }}</td>
            </tr>
            <tr *ngIf="estatisticas.unidadesAtivas.length === 0">
              <td colspan="4" class="empty-cell">Nenhuma unidade com agendamentos este mÃªs</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- ServiÃ§os Mais Vendidos -->
    <div class="info-card full-width">
      <div class="card-title">
        <h3>âœ‚ï¸ ServiÃ§os Mais Vendidos (Este MÃªs)</h3>
      </div>
      <div class="servicos-grid">
        <div *ngFor="let servico of estatisticas.servicosMaisVendidos; let i = index" class="servico-item">
          <div class="servico-rank">{{ i + 1 }}</div>
          <div class="servico-info">
            <div class="servico-nome">{{ servico.servico_nome }}</div>
            <div class="servico-vendas">{{ servico.total_vendido }} vendas</div>
          </div>
        </div>
        <div *ngIf="estatisticas.servicosMaisVendidos.length === 0" class="empty-message">
          Nenhum serviÃ§o vendido este mÃªs
        </div>
      </div>
    </div>

    <!-- Crescimento Mensal -->
    <div class="info-card full-width">
      <div class="card-title">
        <h3>ğŸ“ˆ Crescimento Mensal (Ãšltimos 6 Meses)</h3>
      </div>
      <div class="table-responsive">
        <table class="crescimento-table">
          <thead>
            <tr>
              <th>MÃªs</th>
              <th>Total de Vendas</th>
              <th>Receita</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let mes of estatisticas.crescimentoMensal">
              <td>{{ formatarMes(mes.mes) }}</td>
              <td>{{ mes.total_vendas }}</td>
              <td class="receita">{{ formatarPreco(mes.receita) }}</td>
            </tr>
            <tr *ngIf="estatisticas.crescimentoMensal.length === 0">
              <td colspan="3" class="empty-cell">Nenhum dado disponÃ­vel</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

  </div>
</div>
