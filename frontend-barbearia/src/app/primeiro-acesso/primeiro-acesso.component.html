<div class="primeiro-acesso-container">
  <div class="card-acesso">
    <!-- Header -->
    <div class="header-acesso">
      <div class="icon-acesso">ğŸ”</div>
      <h2>Primeiro Acesso</h2>
      <p class="subtitle">Por seguranÃ§a, Ã© necessÃ¡rio alterar sua senha</p>
    </div>

    <!-- InformaÃ§Ãµes do UsuÃ¡rio -->
    <div class="info-usuario">
      <div class="avatar-grande">
        {{ usuario?.nome?.charAt(0)?.toUpperCase() }}
      </div>
      <div class="dados-usuario">
        <h3>{{ usuario?.nome }}</h3>
        <p>{{ usuario?.email }}</p>
        <span class="badge badge-tipo">{{ usuario?.tipo }}</span>
      </div>
    </div>

    <!-- FormulÃ¡rio -->
    <form (ngSubmit)="alterarSenha()" class="form-senha">
      
      <!-- Senha Atual -->
      <div class="form-group">
        <label for="senhaAtual">Senha Atual <span class="required">*</span></label>
        <div class="input-wrapper">
          <input 
            [type]="mostrarSenhaAtual ? 'text' : 'password'"
            id="senhaAtual"
            [(ngModel)]="senhaAtual"
            name="senhaAtual"
            placeholder="Digite a senha fornecida pelo administrador"
            required
            class="form-input">
          <button 
            type="button" 
            class="btn-toggle-senha"
            (click)="mostrarSenhaAtual = !mostrarSenhaAtual">
            {{ mostrarSenhaAtual ? 'ğŸ‘ï¸' : 'ğŸ‘ï¸â€ğŸ—¨ï¸' }}
          </button>
        </div>
      </div>

      <!-- Nova Senha -->
      <div class="form-group">
        <label for="novaSenha">Nova Senha <span class="required">*</span></label>
        <div class="input-wrapper">
          <input 
            [type]="mostrarNovaSenha ? 'text' : 'password'"
            id="novaSenha"
            [(ngModel)]="novaSenha"
            name="novaSenha"
            (input)="validarSenha()"
            placeholder="Crie uma senha forte"
            required
            class="form-input">
          <button 
            type="button" 
            class="btn-toggle-senha"
            (click)="mostrarNovaSenha = !mostrarNovaSenha">
            {{ mostrarNovaSenha ? 'ğŸ‘ï¸' : 'ğŸ‘ï¸â€ğŸ—¨ï¸' }}
          </button>
        </div>
      </div>

      <!-- Requisitos da Senha -->
      <div class="requisitos-senha" *ngIf="novaSenha">
        <p class="requisitos-titulo">Sua senha deve conter:</p>
        <ul class="requisitos-lista">
          <li [class.valido]="senhaValida.tamanho" [class.invalido]="!senhaValida.tamanho">
            <span class="icone">{{ senhaValida.tamanho ? 'âœ…' : 'âŒ' }}</span>
            MÃ­nimo de 6 caracteres
          </li>
          <li [class.valido]="senhaValida.maiuscula" [class.invalido]="!senhaValida.maiuscula">
            <span class="icone">{{ senhaValida.maiuscula ? 'âœ…' : 'âŒ' }}</span>
            Pelo menos uma letra maiÃºscula
          </li>
          <li [class.valido]="senhaValida.minuscula" [class.invalido]="!senhaValida.minuscula">
            <span class="icone">{{ senhaValida.minuscula ? 'âœ…' : 'âŒ' }}</span>
            Pelo menos uma letra minÃºscula
          </li>
          <li [class.valido]="senhaValida.numero" [class.invalido]="!senhaValida.numero">
            <span class="icone">{{ senhaValida.numero ? 'âœ…' : 'âŒ' }}</span>
            Pelo menos um nÃºmero
          </li>
        </ul>
      </div>

      <!-- Confirmar Senha -->
      <div class="form-group">
        <label for="confirmarSenha">Confirmar Nova Senha <span class="required">*</span></label>
        <div class="input-wrapper">
          <input 
            [type]="mostrarConfirmarSenha ? 'text' : 'password'"
            id="confirmarSenha"
            [(ngModel)]="confirmarSenha"
            name="confirmarSenha"
            placeholder="Digite a senha novamente"
            required
            class="form-input">
          <button 
            type="button" 
            class="btn-toggle-senha"
            (click)="mostrarConfirmarSenha = !mostrarConfirmarSenha">
            {{ mostrarConfirmarSenha ? 'ğŸ‘ï¸' : 'ğŸ‘ï¸â€ğŸ—¨ï¸' }}
          </button>
        </div>
        <small class="senha-match" *ngIf="confirmarSenha && novaSenha">
          <span *ngIf="novaSenha === confirmarSenha" class="match-sim">âœ… As senhas coincidem</span>
          <span *ngIf="novaSenha !== confirmarSenha" class="match-nao">âŒ As senhas nÃ£o coincidem</span>
        </small>
      </div>

      <!-- Mensagem de Erro -->
      <div class="alert alert-erro" *ngIf="erro">
        <strong>âš ï¸ Erro:</strong> {{ erro }}
      </div>

      <!-- BotÃµes -->
      <div class="form-actions">
        <button 
          type="submit" 
          class="btn btn-primary"
          [disabled]="carregando || !senhaAtendeCriterios || novaSenha !== confirmarSenha">
          <span *ngIf="!carregando">ğŸ”’ Alterar Senha e Continuar</span>
          <span *ngIf="carregando">â³ Processando...</span>
        </button>
        <button 
          type="button" 
          class="btn btn-secondary"
          (click)="logout()"
          [disabled]="carregando">
          ğŸšª Sair
        </button>
      </div>
    </form>

    <!-- InformaÃ§Ã£o de SeguranÃ§a -->
    <div class="info-seguranca">
      <div class="info-icon">ğŸ›¡ï¸</div>
      <div class="info-text">
        <strong>Importante:</strong> Escolha uma senha forte e nÃ£o compartilhe com ninguÃ©m. 
        VocÃª poderÃ¡ alterÃ¡-la novamente a qualquer momento nas configuraÃ§Ãµes da sua conta.
      </div>
    </div>
  </div>
</div>
